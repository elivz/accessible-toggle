!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.accessibleToggle=e()}(this,function(){"use strict";var t,e,n=(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){var e=void 0,n=function(){if(null===e||void 0===e){for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];e=requestAnimationFrame((s=this,r=i,function(){e=null,t.apply(s,r)}))}var s,r};return n.cancel=function(){return cancelAnimationFrame(e)},n}}(t={exports:{}},t.exports),t.exports),i=(e=n)&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;var o={trapFocus:!0,assignFocus:!0,closeOnEsc:!0,closeOnClickOutside:!1,mediaQuery:!1,onShow:function(){},onHide:function(){}},s=['a[href]:not([tabindex^="-"]):not([inert])','area[href]:not([tabindex^="-"]):not([inert])',"input:not([disabled]):not([inert])","select:not([disabled]):not([inert])","textarea:not([disabled]):not([inert])","button:not([disabled]):not([inert])",'iframe:not([tabindex^="-"]):not([inert])','[contenteditable]:not([tabindex^="-"]):not([inert])','[tabindex]:not([tabindex^="-"]):not([inert])'],r=9,a=27;function u(t,e){var n=(e||document).querySelectorAll(t);return Array.prototype.slice.call(n)}return function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e&&e instanceof HTMLElement?(this.content=e,this.id=e.id,this.buttons=u("[data-toggle='"+this.id+"']"),this.options=Object.assign({},o,n),this.buttons.length<1?console.warn("Toggle: there are no buttons that control the toggleable element."):!1===this.options.mediaQuery?this.setup():(this.testMediaQuery(),window.addEventListener("resize",i(this.testMediaQuery.bind(this))))):console.warn("Toggle: first parameter must by an HTML element.")}return t.prototype.setup=function(){var t=this;this.active||(this.boundClickHandler=this.clickHandler.bind(this),this.boundKeypressHandler=this.keypressHandler.bind(this),document.addEventListener("keydown",this.boundKeypressHandler),document.addEventListener("click",this.boundClickHandler),this.content.setAttribute("aria-labelledby",this.id+"-control-0"),this.buttons.forEach(function(e,n){e.setAttribute("aria-controls",t.id),e.setAttribute("id",t.id+"-control-"+n)}),this.content.hasAttribute("data-toggle-open")?this.show():this.hide()),this.active=!0},t.prototype.teardown=function(){this.active&&(document.removeEventListener("click",this.boundClickHandler),document.removeEventListener("keyup",this.boundKeyupHandler),this.buttons.forEach(function(t){t.removeAttribute("aria-label"),t.removeAttribute("aria-expanded"),t.removeAttribute("aria-controls"),t.removeAttribute("id")}),this.content.removeAttribute("aria-hidden"),this.content.removeAttribute("aria-labelledby"),this.active=!1)},t.prototype.testMediaQuery=function(){this.options.mediaQuery&&window.matchMedia(this.options.mediaQuery).matches?this.setup():this.teardown()},t.prototype.isOpen=function(){return"true"!==this.content.getAttribute("aria-hidden")},t.prototype.show=function(){if(this.content.setAttribute("aria-hidden","false"),this.buttons.forEach(function(t){t.setAttribute("aria-expanded","true")}),this.options.assignFocus){var t=this.content.querySelector("[autofocus]")||this.getFocusableChildElements()[0];t&&t.focus()}"function"==typeof this.options.onShow&&this.options.onShow();var e=new Event("toggle-show");return this.content.dispatchEvent(e),this},t.prototype.hide=function(){this.content.setAttribute("aria-hidden","true"),this.buttons.forEach(function(t){t.setAttribute("aria-expanded","false")}),"function"==typeof this.options.onShow&&this.options.onHide();var t=new Event("toggle-hide");return this.content.dispatchEvent(t),this},t.prototype.toggle=function(t){return void 0===t&&(t=!this.isOpen()),t?this.show():this.hide(),this},t.prototype.clickHandler=function(t){return this.buttons.indexOf(t.target)>=0?(t.preventDefault(),void this.toggle()):this.options.closeOnClickOutside&&this.isOpen()&&this.content!==t.target&&!this.content.contains(t.target)?(t.preventDefault(),void this.hide()):void 0},t.prototype.keypressHandler=function(t){this.options.closeOnEsc&&this.isOpen()&&t.which===a&&(t.preventDefault(),this.hide(),this.buttons[0].focus()),this.options.trapFocus&&t.which===r&&this.trapFocus(t)},t.prototype.getFocusableChildElements=function(){return u(s.join(","),this.content).filter(function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)})},t.prototype.trapFocus=function(t){var e=this.getFocusableChildElements();if(e.length>0){var n=e.indexOf(document.activeElement)||0;t.shiftKey||n!==e.length-1||(e[0].focus(),t.preventDefault()),t.shiftKey&&0===n&&(e[e.length-1].focus(),t.preventDefault())}},t}()});
