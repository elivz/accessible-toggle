!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.accessibleToggle=e()}(this,function(){"use strict";function t(t,e){var n=(e||document).querySelectorAll(t);return Array.prototype.slice.call(n)}var e=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(function(t,e){return e={exports:{}},t(e,e.exports),e.exports}(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){var e=void 0,n=function(){if(null===e||void 0===e){for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];e=requestAnimationFrame(function(n,i){return function(){e=null,t.apply(n,i)}}(this,i))}};return n.cancel=function(){return cancelAnimationFrame(e)},n}})),n={trapFocus:!0,assignFocus:!0,closeOnEsc:!0,mediaQuery:!1,onShow:function(){},onHide:function(){}},i=['a[href]:not([tabindex^="-"]):not([inert])','area[href]:not([tabindex^="-"]):not([inert])',"input:not([disabled]):not([inert])","select:not([disabled]):not([inert])","textarea:not([disabled]):not([inert])","button:not([disabled]):not([inert])",'iframe:not([tabindex^="-"]):not([inert])','[contenteditable]:not([tabindex^="-"]):not([inert])','[tabindex]:not([tabindex^="-"]):not([inert])'],o={tab:9,esc:27};return function(){function s(i){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),i&&i instanceof HTMLElement?(this.content=i,this.id=i.id,this.buttons=t("[data-toggle='"+this.id+"']"),this.options=Object.assign({},n,o),this.buttons.length<1?console.warn("Toggle: there are no buttons that control the toggleable element."):!1===this.options.mediaQuery?this.setup():(this.testMediaQuery(),window.addEventListener("resize",e(this.testMediaQuery.bind(this))))):console.warn("Toggle: first parameter must by an HTML element.")}return s.prototype.setup=function(){var t=this;this.active||(this.boundClickHandler=this.clickHandler.bind(this),this.boundKeypressHandler=this.keypressHandler.bind(this),this.content.setAttribute("aria-labelledby",this.id+"-control-0"),this.options.closeOnEsc&&this.content.addEventListener("keydown",this.boundKeypressHandler),this.buttons.forEach(function(e,n){e.setAttribute("aria-controls",t.id),e.setAttribute("id",t.id+"-control-"+n),e.addEventListener("click",t.boundClickHandler),e.addEventListener("keydown",t.boundKeypressHandler)}),this.content.getAttribute("data-toggle-open")?this.show():this.hide()),this.active=!0},s.prototype.teardown=function(){var t=this;this.active&&(this.buttons.forEach(function(e){e.removeAttribute("aria-label"),e.removeAttribute("aria-expanded"),e.removeAttribute("aria-controls"),e.removeAttribute("id"),e.removeEventListener("click",t.boundClickHandler)}),this.content.removeAttribute("aria-hidden"),this.content.removeAttribute("aria-labelledby"),this.content.removeEventListener("keyup",this.boundKeyupHandler),this.active=!1)},s.prototype.testMediaQuery=function(){this.options.mediaQuery&&window.matchMedia(this.options.mediaQuery).matches?this.setup():this.teardown()},s.prototype.show=function(){if(this.content.setAttribute("aria-hidden","false"),this.buttons.forEach(function(t){t.setAttribute("aria-expanded","true")}),this.options.assignFocus){var t=this.content.querySelector("[autofocus]")||this.getFocusableChildElements()[0];t&&t.focus()}"function"==typeof this.options.onShow&&this.options.onShow();var e=new Event("toggle-show");return this.content.dispatchEvent(e),this},s.prototype.hide=function(){this.content.setAttribute("aria-hidden","true"),this.buttons.forEach(function(t){t.setAttribute("aria-expanded","false")}),"function"==typeof this.options.onShow&&this.options.onHide();var t=new Event("toggle-hide");return this.content.dispatchEvent(t),this},s.prototype.toggle=function(t){return void 0===t&&(t="true"===this.content.getAttribute("aria-hidden")),t?this.show():this.hide(),this},s.prototype.clickHandler=function(t){this.toggle(),t.preventDefault()},s.prototype.keypressHandler=function(t){if(this.options.closeOnEsc&&t.which===o.esc&&(t.preventDefault(),this.hide(),this.buttons[0].focus()),this.options.trapFocus&&t.which===o.tab){var e=this.getFocusableChildElements();this.trapFocus(e,t)}},s.prototype.getFocusableChildElements=function(){return t(i.join(","),this.content).filter(function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)})},s.prototype.trapFocus=function(t,e){if(t.length>0){var n=t.indexOf(document.activeElement);e.shiftKey||n!==t.length-1||(t[0].focus(),e.preventDefault()),e.shiftKey&&0===n&&(t[t.length-1].focus(),e.preventDefault())}},s}()});
